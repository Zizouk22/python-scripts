import requests
import hashlib
import json

def request_scan(file_hash):
    url = 'https://www.virustotal.com/vtapi/v2/file/report'
    params = {'apikey': 'YOUR_API_KEY', 'resource': file_hash}
    response = requests.get(url, params=params)
    return response.json()

def hash_file(file_path):
    BUF_SIZE = 65536
    sha256 = hashlib.sha256()
    with open(file_path, 'rb') as f:
        while True:
            data = f.read(BUF_SIZE)
            if not data:
                break
            sha256.update(data)
    return sha256.hexdigest()

def main():
    file_path = input("Enter the path of the file to scan: ")
    file_hash = hash_file(file_path)
    scan_result = request_scan(file_hash)
    print(json.dumps(scan_result, indent=4))

if __name__ == "__main__":
    main()
