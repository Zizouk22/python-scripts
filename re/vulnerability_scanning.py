
import nmap

def vulnerability_scanning(target):
    scanner = nmap.PortScanner()
    scanner.scan(target, '1-1024', '-v -sV')
    for host in scanner.all_hosts():
        print('Host : %s (%s)' % (host, scanner[host].hostname()))
        print('State : %s' % scanner[host].state())
        for proto in scanner[host].all_protocols():
            print('----------')
            print('Protocol : %s' % proto)
            lport = scanner[host][proto].keys()
            for port in lport:
                print ('port : %s\tstate : %s' % (port, scanner[host][proto][port]['state']))

if __name__ == "__main__":
    target = "127.0.0.1"
    vulnerability_scanning(target)
